oto=to=too=noo=null,timer=document.getElementById("gu_timer").value;const gu_next_save=document.getElementById("gu_next_save"),gu_is_modified=document.getElementById("is_modified"),gu_auto_save_msg=document.getElementById("gu_auto_save_msg");document.getElementById("gu_auto_save_field").style.display="",document.getElementById("gu_auto_save_overlay").style.display="";function gu_presend_check(){return""==document.send_form.msg_recips.value?(alert(l_gu_presend_check_alert),!1):""!=document.send_form.msg_subject.value||confirm(l_gu_presend_check_confirm)}function gu_add_recipient(){let a=document.send_form.msg_recips,b=document.send_form.send_lists;a.value=gu_trim(a.value),0>a.value.search(b.value)&&(""!=a.value&&(a.value+="; "),a.value+=b.value,gu_set_modified(!0))}function gu_cancel_unsaved_warning(){is_post_back=!0}function gu_set_modified(a){gu_is_modified.value=a?1:0}function gu_auto_save_renew(){let a=document.getElementById("gu_timer").value,b=gu_is_modified.value;gu_timeoutHandle&&window.clearTimeout(gu_timeoutHandle),gu_plx_domain&&gu_plx_domain==gu_now_domain?(gu_plx_domain=0,gu_timeoutHandle=setTimeout(gu_auto_save,a)):window.location=gu_ajax_url_auto_save_renew}function gu_auto_save(){to||(to=document.querySelector("#gu_auto_save_overlay > span > b"),oto=to.textContent);let cm=document.querySelector("[aria-label=\"HTML source code\"]");document.querySelector("#mceu_1[aria-disabled=\"false\"]")&&gu_set_modified(!0);let time=document.getElementById("gu_timer").value,is_modified=gu_is_modified.value;if(gu_next_save_set(),2>time)return void(gu_timeoutHandle&&window.clearTimeout(gu_timeoutHandle));if(is_modified&&gu_is_edited&&gu_is_previewed)setTimeout(function(){if("#gu_auto_save_overlay"==window.location.hash){document.getElementById("gu_no_save_btn").style.display="none";let a=document.querySelector("[aria-label=\"HTML source code\"]");a?(setTimeout(function(){document.getElementById("save_submit").click()},1111),a.querySelectorAll("button")[1].click()):document.getElementById("save_submit").click();try{localStorage.setItem("gu_auto_save",new Date().toLocaleString())}catch(a){}}else 0<time&&(gu_timeoutHandle&&window.clearTimeout(gu_timeoutHandle),gu_timeoutHandle=setTimeout(gu_auto_save,time),gu_next_save_set(),clearInterval(too),to.textContent=oto)},5e3),1<time&&(window.location.hash="gu_auto_save_overlay",too=setInterval(function(){0<to.textContent?--to.textContent:clearInterval(too)},1e3));else if(1<time)if(gu_is_edited=gu_is_previewed=!0,!gu_plx_domain){let mysack=new sack(gu_ajax_url_auto_save);mysack.execute=1,mysack.method="GET",mysack.setVar("gu_plx_domain","ajax"),mysack.runResponse=function(){try{eval(this.response)}catch(a){console.log("Error gu_auto_save",a)}},mysack.onError=function(){gu_error(l_gu_error_ajax),gu_messages_display(0)},mysack.onCompletion=function(){200==mysack.xmlhttp.status&&gu_auto_save_renew()},mysack.runAJAX()}else gu_timeoutHandle&&window.clearTimeout(gu_timeoutHandle),gu_plx_domain&&gu_plx_domain==gu_now_domain&&(gu_plx_domain=0,gu_timeoutHandle=setTimeout(gu_auto_save,time))}function gu_auto_save_is_active(){let a=document.getElementById("gu_timer").value;document.getElementById("autosave").value=a,2>a?gu_timeoutHandle&&window.clearTimeout(gu_timeoutHandle):(!timer&&a||timer!=a)&&(gu_timeoutHandle&&window.clearTimeout(gu_timeoutHandle),gu_timeoutHandle=setTimeout(gu_auto_save,a)),timer=a,gu_next_save_set()}function gu_next_save_set(){noo&&clearInterval(noo),gu_next_save.textContent=2>timer?"--":timer/1e3,1<timer&&(noo=setInterval(function(){0<gu_next_save.textContent?--gu_next_save.textContent:clearInterval(noo)},1e3))}window.onbeforeunload=function(){let a=gu_is_modified.value;if(!is_post_back&&a)return l_gu_post_back},document.addEventListener("DOMContentLoaded",function(){let a="";gu_auto_save(),gu_next_save_set();try{a=localStorage.getItem("gu_auto_save"),localStorage.removeItem("gu_auto_save")}catch(a){}a&&(gu_auto_save_msg.innerHTML=" <b class=\"gu_auto_save_msg\">"+l_gu_auto_save+" <i>"+a+"</i></b>")}),document.getElementById("gu_timer").addEventListener("change",gu_auto_save_is_active);